[SERVICE]
    Flush         1
    Log_Level     info
    Parsers_File  ./parsers.conf

[INPUT]
    NAME   dummy
    Dummy  {"kubernetes": {"namespace_name": "kube-system"}}
    Tag    old_tag.postfix.1

[INPUT]
    NAME   dummy
    Dummy  {"kubernetes": {"namespace_name": "not-kube-system"}}
    Tag    old_tag.postfix.2

[INPUT]
    NAME   dummy
    Dummy  {"log": "test"}
    Tag    old_tag.postfix.3

[INPUT]
    NAME   dummy
    Dummy  {"kubernetes": {"namespace": "fake"}, "log": "2020-11-18T00:37:23.990978379Z stdout F Test msg"}
    Tag    parser.test

[FILTER]
    Name          parser
    Match         parser.*
    Key_Name      log
    Parser        cri_o
    Reserve_Data  True

[FILTER]
    Name   rewrite_tag
    Match  old_tag.*
    Rule   $kubernetes['namespace_name'] ^(kube-system)$ new_tag.$TAG false

[FILTER]
    Name   rewrite_tag
    Match  old_tag.*
    Rule   $kubernetes['namespace_name'] .* new_tag.2.$TAG false

[OUTPUT]
    Name   stdout
    Match  *
